# Описания проекта 'Восстановление золота из руды'


## Данные

Нам даны 3 датасета с информацией о различных параметрах процесса переработки сырья. Данные находятся в трёх файлах:
- `gold_industry_train.csv` — обучающая выборка;
- `gold_industry_test.csv` — тестовая выборка;
- `gold_industry_full.csv` — исходные данные. 

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи. \
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в **тестовой выборке отсутствуют некоторые признаки**, которые могут быть в обучающей. \
Также **в тестовом наборе нет целевых признаков**. **Исходный датасет** содержит обучающую и тестовую выборки **со всеми признаками**.

**Технологический процесс** 
- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
    - Xanthate **— ксантогенат (промотер, или активатор флотации);
    - Sulphate — сульфат (на данном производстве сульфид натрия);
    - Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

**Параметры этапов** 
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи

Наименование признаков строится следующим образом: \
`[этап].[тип_параметра].[название_параметра]` 

Пример: `rougher.input.feed_ag` 

Возможные значения для блока `этап`:
- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики

Возможные значения для блока `тип_параметра`:
- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики

## Задача

Подготовьте прототип модели машинного обучения для компании «Цифра», которая разрабатывает решения для эффективной работы промышленных предприятий. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды.
Провести исследовательский анализ данных и выбрать лучшую модель с помощью кросс-валидации.

## Результат
Было сделано следующее:
- рассмотрены изменения концентраций металлов на различных этапах очистки
- сравнение распределений размеров гранул сырья на обучающей и тестовой выборках
- посчитана суммарная концентрация металлов на всех стадиях процесса
- введена новая метрика **sMAPE** (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»)

В качестве лучшей модели был выбран случайный лес (его ошибка на тестовых данных составила **6.4** против **8.4** у константной).


## Стек
*Python*, *Matplotlib*, *NumPy*, *Sklearn*